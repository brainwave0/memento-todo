var AndroidAlarm={create:function(hour,minutes,message,options){i=intent("android.intent.action.SET_ALARM");i.extraInt("android.intent.extra.alarm.HOUR",hour);i.extraInt("android.intent.extra.alarm.MINUTES",minutes);if(message!==undefined)i.extra("android.intent.extra.alarm.MESSAGE",message);if(options!==undefined){if(options.days!==undefined)i.extraArrayInt("android.intent.extra.alarm.DAYS",options.days);if(options.vibrate!==undefined)i.extraBool("android.intent.extra.alarm.VIBRATE",options.vibrate);if(options.skipUI!==undefined)i.extraBool("android.intent.extra.alarm.SKIP_UI",options.skipUI)}i.send()},timer:function(length,message,skipUI){i=intent("android.intent.action.SET_TIMER");i.extraInt("android.intent.extra.alarm.LENGTH",length);if(message!==undefined)i.extra("android.intent.extra.alarm.MESSAGE",message);if(skipUI!==undefined)i.extraBool("android.intent.extra.alarm.SKIP_UI",skipUI);i.send()}};var timer_duration=32*60;function to_array(iterable){var result=[];for(var i=0;i<iterable.length;i++){result.push(iterable[i])}return result}function ready(task){return!task.field("Start datetime")||task.field("Start datetime")<Date.now()}function active_tasks(){return to_array(lib().entries()).filter(function(x){return ready(x)})}function get_all_tasks(){return to_array(lib().entries())}function sum(nums){return nums.reduce(function(a,b){return a+b},0)}function shuffleArray(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var temp=array[i];array[i]=array[j];array[j]=temp}return array}function start(task){setTimer();create_log_entry("Started task \""+entry().field("Name")+"\"");task.set("Timer start",Date.now())}function finish(task){create_log_entry("Finished task \""+entry().field("Name")+"\"");task.set("Runtime",task.field("Runtime")+elapsed());task.set("Total runtime",task.field("Total runtime")+elapsed());task.set("Value",task.field("Value")+arg("Rating"));task.set("Latest attempt",Date.now())}function setTimer(){AndroidAlarm.timer(timer_duration,entry().field("Name"),false)}function toggleRunning(task){task.set("Running",!task.field("Running"))}function elapsed(){return Date.now()-entry().field("Timer start")}function create_log_entry(text){libByName("Log").create({Description:text,Datetime:Date.now()})}if(entry().field("Running")){finish(entry())}else{start(entry())}toggleRunning(entry());
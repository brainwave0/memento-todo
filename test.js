var test_data=[{Name:"Shave ","Repeat Interval":115200000,Deadline:null,"Expected runtime":217000,Importance:-1,"Start datetime":new Date(2019,12,8,20,7,50),Runtime:0,"Timer start":new Date(2019,12,6,19,30,50),"Latest attempt":new Date(2019,12,6,19,34,28),Value:3,"Total runtime":217256,randnum:0.029378891169037},{Name:"Walk Lucy ","Repeat Interval":28800000,Deadline:null,"Expected runtime":1958000,Importance:0,"Start datetime":new Date(2019,12,7,18,52,34),Runtime:0,"Timer start":new Date(2019,12,7,10,18,40),"Latest attempt":new Date(2019,12,7,10,52,30),Value:6,"Total runtime":3988622,randnum:0.055731044512516},{Name:"Pay off credit card ","Repeat Interval":null,Deadline:null,"Expected runtime":120000,Importance:-1,"Start datetime":new Date(2020,1,1,0,0,14),Runtime:0,"Timer start":new Date(2019,12,1,7,34,38),"Latest attempt":null,Value:0,"Total runtime":0,randnum:0.103116783989486},{Name:"Lift ","Repeat Interval":86400000,Deadline:null,"Expected runtime":203000,Importance:-1,"Start datetime":new Date(2019,12,7,19,30,12),Runtime:0,"Timer start":new Date(2019,12,6,19,26,18),"Latest attempt":new Date(2019,12,6,19,29,42),Value:3,"Total runtime":203786,randnum:0.112546814586199},{Name:"Recreation ","Repeat Interval":null,Deadline:null,"Expected runtime":0,Importance:-1,"Start datetime":new Date(2019,12,5,10,20,10),Runtime:0,"Timer start":new Date(2019,12,5,13,55,51),"Latest attempt":new Date(2019,12,4,16,37,3),Value:0,"Total runtime":0,randnum:0.171995745383323},{Name:"Clean mask ","Repeat Interval":86400000,Deadline:null,"Expected runtime":240000,Importance:-1,"Start datetime":new Date(2019,12,8,10,56,13),Runtime:0,"Timer start":new Date(2019,12,7,10,53,29),"Latest attempt":new Date(2019,12,7,10,56,10),Value:2,"Total runtime":160664,randnum:0.185188281205543},{Name:"Create unit tests for memento-todo ","Repeat Interval":null,Deadline:null,"Expected runtime":0,Importance:-1,"Start datetime":new Date(2019,12,7,8,53,21),Runtime:5112775,"Timer start":new Date(2019,12,7,13,36,3),"Latest attempt":new Date(2019,12,7,13,23,12),Value:8,"Total runtime":5112813,randnum:0.269858417569511},{Name:"Brush teeth ","Repeat Interval":43200000,Deadline:null,"Expected runtime":120000,Importance:-1,"Start datetime":new Date(2019,12,8,0,19,12),Runtime:0,"Timer start":new Date(2019,12,7,12,17,3),"Latest attempt":new Date(2019,12,7,12,19,7),Value:1,"Total runtime":124072,randnum:0.310750911590584},{Name:"Forehead medicine ","Repeat Interval":28800000,Deadline:null,"Expected runtime":120000,Importance:-1,"Start datetime":new Date(2019,12,7,20,11,54),Runtime:0,"Timer start":new Date(2019,12,7,12,9,18),"Latest attempt":new Date(2019,12,7,12,11,49),Value:1,"Total runtime":151023,randnum:0.340811292912416},{Name:"Stretch","Repeat Interval":259200000,Deadline:null,"Expected runtime":300000,Importance:-1,"Start datetime":new Date(2019,12,9,18,21,58),Runtime:282558,"Timer start":new Date(2019,12,6,18,17,10),"Latest attempt":new Date(2019,12,6,18,21,52),Value:3,"Total runtime":282000,randnum:0.43104755201178},{Name:"Put stuff away and update Inventory ","Repeat Interval":86400000,Deadline:null,"Expected runtime":300000,Importance:-1,"Start datetime":new Date(2019,12,7,20,3,32),Runtime:0,"Timer start":new Date(2019,12,4,15,33,23),"Latest attempt":new Date(2019,12,4,15,53,50),Value:0,"Total runtime":0,randnum:0.442782501163462},{Name:"Learn Japanese ","Repeat Interval":14400000,Deadline:null,"Expected runtime":3478000,Importance:-1,"Start datetime":new Date(2019,12,7,15,9,41),Runtime:0,"Timer start":new Date(2019,12,7,10,56,49),"Latest attempt":new Date(2019,12,7,11,9,26),Value:10,"Total runtime":4235720,randnum:0.450475968431321},{Name:"Laundry ","Repeat Interval":115200000,Deadline:null,"Expected runtime":720000,Importance:-1,"Start datetime":new Date(2019,12,8,21,32,11),Runtime:0,"Timer start":new Date(2019,12,3,16,42,0),"Latest attempt":new Date(2019,12,3,16,45,3),Value:0,"Total runtime":0,randnum:0.454726194165271},{Name:"Cook ","Repeat Interval":7200000,Deadline:null,"Expected runtime":1844000,Importance:-1,"Start datetime":new Date(2019,12,7,15,3,22),Runtime:0,"Timer start":new Date(2019,12,7,12,32,57),"Latest attempt":new Date(2019,12,7,13,3,13),Value:5,"Total runtime":2019240,randnum:0.460954934711386},{Name:"Cancel Crunchyroll ","Repeat Interval":115200000,Deadline:null,"Expected runtime":300000,Importance:-1,"Start datetime":new Date(2019,12,8,20,12,39),Runtime:0,"Timer start":new Date(2019,12,7,12,12,17),"Latest attempt":null,Value:0,"Total runtime":0,randnum:0.476540670976147},{Name:"Clear the counters ","Repeat Interval":28800000,Deadline:null,"Expected runtime":180000,Importance:-1,"Start datetime":new Date(2019,12,7,20,24,11),Runtime:0,"Timer start":new Date(2019,12,7,12,23,17),"Latest attempt":new Date(2019,12,7,12,24,7),Value:3,"Total runtime":230129,randnum:0.572762817537926},{Name:"Shower ","Repeat Interval":86400000,Deadline:null,"Expected runtime":900000,Importance:-1,"Start datetime":new Date(2019,12,7,12,0,11),Runtime:0,"Timer start":new Date(2019,12,4,21,47,22),"Latest attempt":new Date(2019,12,4,22,1,30),Value:0,"Total runtime":0,randnum:0.596323300795834},{Name:"Mop ","Repeat Interval":115200000,Deadline:null,"Expected runtime":1200000,Importance:-1,"Start datetime":new Date(2019,12,8,20,19,35),Runtime:0,"Timer start":new Date(2019,12,5,11,51,18),"Latest attempt":new Date(2019,12,5,11,53,26),Value:0,"Total runtime":0,randnum:0.618716945285392},{Name:"Disinfect BiPAP ","Repeat Interval":null,Deadline:null,"Expected runtime":600000,Importance:-1,"Start datetime":new Date(2019,12,11,0,0,25),Runtime:0,"Timer start":null,"Latest attempt":null,Value:0,"Total runtime":0,randnum:0.633031758799218},{Name:"Clean your bathroom ","Repeat Interval":115200000,Deadline:null,"Expected runtime":1200000,Importance:-1,"Start datetime":new Date(2019,12,8,3,35,0),Runtime:0,"Timer start":new Date(2019,12,2,20,7,12),"Latest attempt":null,Value:0,"Total runtime":0,randnum:0.642095147197263},{Name:"Restart network ","Repeat Interval":null,Deadline:null,"Expected runtime":10000,Importance:0,"Start datetime":new Date(2019,12,8,0,0,22),Runtime:0,"Timer start":new Date(2019,12,1,7,40,13),"Latest attempt":null,Value:0,"Total runtime":0,randnum:0.662470530426871},{Name:"Cancel ProtonVPN ","Repeat Interval":2592000000,Deadline:null,"Expected runtime":300000,Importance:-1,"Start datetime":new Date(2019,12,23,8,51,3),Runtime:0,"Timer start":new Date(2019,11,23,8,48,17),"Latest attempt":null,Value:0,"Total runtime":0,randnum:0.699800911050167},{Name:"Manage music collection ","Repeat Interval":null,Deadline:null,"Expected runtime":0,Importance:-1,"Start datetime":new Date(2019,12,5,10,20,10),Runtime:2197555,"Timer start":new Date(2019,12,7,11,22,15),"Latest attempt":new Date(2019,12,7,11,58,53),Value:3,"Total runtime":2197564,randnum:0.717464786121645},{Name:"Pick up the poops ","Repeat Interval":115200000,Deadline:null,"Expected runtime":600000,Importance:-1,"Start datetime":new Date(2019,12,8,20,25,30),Runtime:0,"Timer start":new Date(2019,12,2,16,37,14),"Latest attempt":null,Value:0,"Total runtime":0,randnum:0.749538687931598},{Name:"Meds ","Repeat Interval":57600000,Deadline:null,"Expected runtime":300000,Importance:-1,"Start datetime":new Date(2019,12,8,1,4,2),Runtime:0,"Timer start":new Date(2019,12,7,9,2,37),"Latest attempt":new Date(2019,12,7,9,3,52),Value:0,"Total runtime":75004,randnum:0.763464856933075},{Name:"Adjust bedtime ","Repeat Interval":172800000,Deadline:null,"Expected runtime":187000,Importance:-1,"Start datetime":new Date(2019,12,9,9,2,28),Runtime:0,"Timer start":new Date(2019,12,6,19,22,20),"Latest attempt":new Date(2019,12,6,19,25,27),Value:1,"Total runtime":187174,randnum:0.831859284617407},{Name:"trash","Repeat Interval":57600000,Deadline:null,"Expected runtime":300000,Importance:-1,"Start datetime":new Date(2019,12,8,1,0,13),Runtime:0,"Timer start":new Date(2019,12,6,18,23,19),"Latest attempt":new Date(2019,12,6,18,29,2),Value:3,"Total runtime":343072,randnum:0.848651908193901},{Name:"Do the dishes ","Repeat Interval":28800000,Deadline:null,"Expected runtime":600000,Importance:-1,"Start datetime":new Date(2019,12,7,17,18,40),Runtime:0,"Timer start":new Date(2019,12,7,9,5,5),"Latest attempt":new Date(2019,12,7,9,18,36),Value:3,"Total runtime":810757,randnum:0.9090040012878},{Name:"Enroll","Repeat Interval":null,Deadline:new Date(2020,1,18,0,0,1),"Expected runtime":0,Importance:-1,"Start datetime":new Date(2020,1,21,0,0,51),Runtime:0,"Timer start":new Date(2019,12,4,12,24,20),"Latest attempt":new Date(2019,12,4,12,35,39),Value:0,"Total runtime":0,randnum:0.910619573500944},{Name:"Refill the dogs water bowls ","Repeat Interval":230400000,Deadline:null,"Expected runtime":300000,Importance:-1,"Start datetime":new Date(2019,12,10,1,4,51),Runtime:0,"Timer start":new Date(2019,12,3,13,30,45),"Latest attempt":null,Value:0,"Total runtime":0,randnum:0.943976959660287},{Name:"Clean water chamber and tubing ","Repeat Interval":172800000,Deadline:null,"Expected runtime":240000,Importance:-1,"Start datetime":new Date(2019,12,6,13,37,1),Runtime:0,"Timer start":new Date(2019,12,4,13,33,33),"Latest attempt":new Date(2019,12,4,13,36,54),Value:0,"Total runtime":0,randnum:0.961314966128457},{Name:"Rinse the blue filter ","Repeat Interval":604800000,Deadline:null,"Expected runtime":120000,Importance:-1,"Start datetime":new Date(2019,12,12,12,2,10),Runtime:0,"Timer start":new Date(2019,12,5,12,0,41),"Latest attempt":new Date(2019,12,5,12,2,5),Value:0,"Total runtime":0,randnum:0.962110063008638}];var Entry=function(){function Entry(){this.fields={};this.id=0}Entry.prototype.field=function(name){return this.fields[name]};Entry.prototype.set=function(name,value){this.fields[name]=value};Entry.prototype.show=function(){return this};return Entry}();var Entries=function(){function Entries(){this.next_id=0;this.length=0}return Entries}();var Library=function(){function Library(){}Library.prototype.entries=function(){return entries};Library.prototype.create=function(values){var new_entry=new Entry;new_entry.id=entries.length;new_entry.fields=values;entries[entries.next_id]=new_entry;entries.next_id+=1;entries.length+=1};return Library}();function entry(){return current_entry}function lib(){return library}function arg(name){return args[name]}function libByName(name){return new Library}function message(x){console.log(x)}var current_entry;var library;var entries;var args={};function to_array(iterable){var result=[];for(var i=0;i<iterable.length;i++){result.push(iterable[i])}return result}function ready(task){return!task.field("Start datetime")||task.field("Start datetime").getTime()<=Date.now()}function active_tasks(){return to_array(lib().entries()).filter(function(x){return ready(x)})}function get_all_tasks(){return to_array(lib().entries())}function sum(nums){return nums.reduce(function(a,b){return a+b},0)}function shuffle_array(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var temp=array[i];array[i]=array[j];array[j]=temp}return array}var SortDir;(function(SortDir){SortDir[SortDir["Ascending"]=0]="Ascending";SortDir[SortDir["Descending"]=1]="Descending"})(SortDir||(SortDir={}));function sort(elems,field_selector,sort_direction){if(sort_direction==SortDir.Ascending){return elems.sort(function(a,b){return field_selector(a)-field_selector(b)})}else{return elems.sort(function(a,b){return field_selector(b)-field_selector(a)})}}function copy_array(xs){var result=[];for(var _i=0,xs_1=xs;_i<xs_1.length;_i++){var x=xs_1[_i];result.push(x)}return result}function xbisect(value,more){if(Math.log(value)/Math.log(2)%1===0){if(more){return value*2}else{return value-value/4}}var x=1;while(x<value){x*=2}var delta=x;while(x!=value){delta/=2;if(x<value){x+=delta}else if(x>value){x-=delta}}if(more){x+=delta/2}else{x-=delta/2}return x}function adjust_priority(amount){var avg_priority=average_priority();if(avg_priority<0&&amount<0||avg_priority>=0&&amount>0){adjust_other(entry(),-amount)}else if(avg_priority<0&&amount>0||avg_priority>=0&&amount<0){entry().set("Importance",entry().field("Importance")+amount)}}function adjust_other(entry,amount){get_all_tasks().filter(function(x){return x.id!=entry.id}).forEach(function(x){return x.set("Importance",x.field("Importance")+amount)})}function average_priority(){var all_tasks=get_all_tasks();return sum(all_tasks.map(function(x){return x.field("Importance")}))/all_tasks.length}function instant_runoff(lists){var first_choices=lists.map(head);var candidate_votes=counts(first_choices);var total_votes=sum(candidate_votes.map(second));var winner=head(head(candidate_votes.filter(function(x){return x[1]>total_votes/2})));if(winner){return winner}else{var last_place_candidate_1=head(head(candidate_votes.sort(function(a,b){return a[0].field("randnum")-b[0].field("randnum")}).sort(function(a,b){return a[1]-b[1]})));if(last_place_candidate_1&&first_choices.length>1){return instant_runoff(lists.map(function(xs){return xs.filter(function(x){return x!=last_place_candidate_1})}).filter(function(x){return x.length>0}))}else if(first_choices.length==1){return first_choices[0]}else{throw"failed to pick"}}}function counts(xs){var count_map=[];for(var _i=0,xs_2=xs;_i<xs_2.length;_i++){var x=xs_2[_i];var index_1=count_map.map(head).indexOf(x);if(index_1>-1){count_map[index_1][1]+=1}else{count_map.push([x,1])}}return count_map}function head(xs){if(xs){return xs[0]}else{return undefined}}function second(pair){return pair[1]}function print_lists(lists){for(var _i=0,lists_1=lists;_i<lists_1.length;_i++){var list=lists_1[_i];var line="";for(var _a=0,list_1=list;_a<list_1.length;_a++){var x=list_1[_a];line+=Math.floor(x.field("randnum")*1000)+" "}console.log(line)}console.log()}var AndroidAlarm={create:function(hour,minutes,message,options){i=intent("android.intent.action.SET_ALARM");i.extraInt("android.intent.extra.alarm.HOUR",hour);i.extraInt("android.intent.extra.alarm.MINUTES",minutes);if(message!==undefined)i.extra("android.intent.extra.alarm.MESSAGE",message);if(options!==undefined){if(options.days!==undefined)i.extraArrayInt("android.intent.extra.alarm.DAYS",options.days);if(options.vibrate!==undefined)i.extraBool("android.intent.extra.alarm.VIBRATE",options.vibrate);if(options.skipUI!==undefined)i.extraBool("android.intent.extra.alarm.SKIP_UI",options.skipUI)}i.send()},timer:function(length,message,skipUI){i=intent("android.intent.action.SET_TIMER");i.extraInt("android.intent.extra.alarm.LENGTH",length);if(message!==undefined)i.extra("android.intent.extra.alarm.MESSAGE",message);if(skipUI!==undefined)i.extraBool("android.intent.extra.alarm.SKIP_UI",skipUI);i.send()}};var timer_duration=32*60;function start(entry){create_log_entry("Started entry \""+entry.field("Name")+"\"");entry.set("Timer start",new Date(Date.now()));toggle_running(entry)}function finish(){create_log_entry("Finished entry \""+entry().field("Name")+"\"");entry().set("Runtime",entry().field("Runtime")+elapsed());entry().set("Total runtime",entry().field("Total runtime")+elapsed());entry().set("Value",entry().field("Value")+arg("Rating"));toggle_running(entry())}function set_timer(){AndroidAlarm.timer(timer_duration,entry().field("Name"),false)}function toggle_running(entry){entry.set("Running",!entry.field("Running"))}function elapsed(){return Date.now()-entry().field("Timer start").getTime()}function create_log_entry(text){libByName("Log").create({Description:text,Datetime:new Date(Date.now())})}function start_stop(){if(entry().field("Running")){finish()}else{start(entry())}}function reschedule(){if(arg("Adjust repeat interval")=="Less"){bisect_repeat_interval(false)}else if(arg("Adjust repeat interval")=="More"){bisect_repeat_interval(true)}if(arg("Specific datetime")){entry().set("Start datetime",arg("Specific datetime"))}else if(arg("Repeat interval")){entry().set("Start datetime",new Date(Date.now()+entry().field("Repeat Interval")))}else if(arg("Specific duration")){entry().set("Start datetime",new Date(Date.now()+arg("Specific duration")))}}function bisect_repeat_interval(more){entry().set("Repeat interval",xbisect(entry().field("Repeat interval")/1000/60/60,more)*1000*60*60)}var sort_orders=[function start_datetime(entries){return sort(entries,function(e){return e.field("Start datetime+")||new Date(0)},SortDir.Ascending)},function deadline(entries){return sort(entries,function(e){return e.field("Deadline")||new Date(0)},SortDir.Ascending)},function value(entries){return sort(entries,function(e){return e.field("Value")/e.field("Total runtime")||1},SortDir.Descending)},function importance(entries){return sort(entries,function(e){return e.field("Importance")},SortDir.Descending)},function remaining_runtime(entries){return sort(entries,function(e){return e.field("Expected runtime")?e.field("Expected runtime")-e.field("Runtime"):e.field("Runtime")},SortDir.Ascending)}];function pick_task(){var lists=[];for(var _i=0,sort_orders_1=sort_orders;_i<sort_orders_1.length;_i++){var fn=sort_orders_1[_i];lists.push(copy_array(fn(active_tasks())))}var task=instant_runoff(lists);start(task);task.show();return task}function increase_priority(){adjust_priority(1)}function decrease_priority(){adjust_priority(-1)}function cancel(){entry().set("Running",false)}function init_sim(){current_entry=null;library=new Library;entries=new Entries;args={};for(var _i=0,test_data_1=test_data;_i<test_data_1.length;_i++){var obj=test_data_1[_i];library.create(Object.assign({},obj))}}function assert(p,msg){if(!p){throw msg}}init_sim();current_entry=lib().entries()[0];start_stop();cancel();assert(entry().field("Running")==false,"Failed to cancel running task.");init_sim();var sorted_tasks=sort(get_all_tasks(),function(x){return x.field("Importance")},SortDir.Descending);current_entry=lib().entries()[Math.floor(lib().entries().length/2)];var index=sorted_tasks.findIndex(function(x){return x.field("Name")==entry().field("Name")});decrease_priority();sorted_tasks=sort(get_all_tasks(),function(x){return x.field("Importance")},SortDir.Descending);var new_index=sorted_tasks.findIndex(function(x){return x.field("Name")==entry().field("Name")});assert(new_index>index,"Failed to decrease priority.");init_sim();sorted_tasks=sort(get_all_tasks(),function(x){return x.field("Importance")},SortDir.Descending);current_entry=lib().entries()[Math.floor(lib().entries().length/2)];index=sorted_tasks.findIndex(function(x){return Object.is(x,entry())});increase_priority();sorted_tasks=sort(get_all_tasks(),function(x){return x.field("Importance")},SortDir.Descending);assert(sorted_tasks.findIndex(function(x){return Object.is(x,entry())})<index,"Failed to increase priority.");init_sim();var task=pick_task();assert(task.field("Name")=="Shave ","Picked the wrong task.");assert(task.field("Running"),"Task didn't automatically start.");init_sim();var specific_datetime=new Date(Date.now()+64*60*60*1000);args["Specific datetime"]=specific_datetime;current_entry=lib().entries()[0];var prev_start=entry().field("Start datetime");reschedule();assert(entry().field("Start datetime")-prev_start<365*24*60*60*1000,"Start datetime set to unexpectedly later date.");assert(entry().field("Start datetime")-prev_start>=60*1000,"Start datetime set to unexpectedly early date.");assert(entry().field("Start datetime").getTime()===specific_datetime.getTime(),"Failed to reschedule using specific datetime.");init_sim();var repeat_interval=64*60*60*1000;args["Repeat interval"]=true;current_entry=lib().entries()[0];entry().set("Repeat interval",repeat_interval);prev_start=entry().field("Start datetime");reschedule();assert(entry().field("Start datetime")-prev_start<365*24*60*60*1000,"Start datetime set to unexpectedly later date.");assert(entry().field("Start datetime")-prev_start>=60*1000,"Start datetime set to unexpectedly early date.");assert(entry().field("Start datetime").getTime()<=new Date(Date.now()+repeat_interval).getTime(),"Failed to reschedule using repeat interval.");init_sim();repeat_interval=64*60*60*1000;args["Repeat interval"]=true;args["Adjust repeat interval"]="Less";current_entry=lib().entries()[0];entry().set("Repeat interval",repeat_interval);prev_start=entry().field("Start datetime");reschedule();assert(entry().field("Start datetime")-prev_start<365*24*60*60*1000,"Start datetime set to unexpectedly later date.");assert(entry().field("Start datetime")-prev_start>=60*1000,"Start datetime set to unexpectedly early date.");console.log(entry().field("Start datetime").getTime()-new Date(Date.now()+48*60*60*1000).getTime());assert(Math.abs(entry().field("Repeat interval")-48*60*60*1000)<1000,"Failed to reschedule using repeat interval.");init_sim();var duration=64*60*60*1000;args["Specific duration"]=duration;current_entry=lib().entries()[0];prev_start=entry().field("Start datetime");reschedule();assert(entry().field("Start datetime")-prev_start<365*24*60*60*1000,"Start datetime set to unexpectedly later date.");assert(entry().field("Start datetime")-prev_start>=60*1000,"Start datetime set to unexpectedly early date.");assert(entry().field("Start datetime").getTime()<=new Date(Date.now()+duration).getTime(),"Failed to reschedule using specific duration.");init_sim();current_entry=lib().entries()[0];start_stop();assert(entry().field("Running"),"Failed to start task.");start_stop();assert(!entry().field("Running"),"Failed to stop task.");init_sim();current_entry=lib().entries()[0];start(entry());assert(entry().field("Timer start")>=new Date(Date.now()),"Failed to set timer start.");assert(entry().field("Running"),"Task not running after being started.");init_sim();current_entry=lib().entries()[0];start(entry());finish();assert(!entry().field("Running"),"Task still running after being stopped.");init_sim();current_entry=lib().entries()[0];toggle_running(entry());assert(entry().field("Running"),"Failed to toggle running state.");init_sim();var elapsed_duration=50*60*60*1000;current_entry=lib().entries()[0];entry().set("Timer start",new Date(Date.now()-elapsed_duration));assert(elapsed()>=elapsed_duration,"Failed to calculate elapsed time.");var count_results=counts([4,4,2,4,1,3,5,5,2,3]);var expected_results=[[4,3],[2,2],[1,1],[3,2],[5,2]];if(count_results.length==expected_results.length){for(var i=0;i<count_results.length;i++){assert(count_results[i][0]==expected_results[i][0],"Wrong value in count function results.");assert(count_results[i][1]==expected_results[i][1],"Wrong count in count function results.")}}else{console.log("Count function return value is the wrong length.")}assert(head([1,2])==1,"head failed");assert(head([])===undefined,"head didn't return undefined");assert(second([1,3])==3,"second failed");init_sim();current_entry=lib().entries()[0];adjust_priority(1);assert(entry().field("Importance")==0,"set priority failed (4)");assert(average_priority()==-0.90625,"set priority failed (1)");init_sim();current_entry=lib().entries()[0];adjust_priority(-1);assert(entry().field("Importance")==-1,"set priority failed (3)");assert(average_priority()==0.03125,"set priority failed (2)");init_sim();current_entry=lib().entries()[0];adjust_other(entry(),-2);assert(Math.floor(average_priority()*1000)==-2875,"adjust_other failed");init_sim();assert(average_priority()==-0.9375,"average_priority failed");init_sim();assert(Array.isArray(to_array(lib().entries())),"to_array didn't make an array.");init_sim();var e=lib().entries()[0];e.set("Start datetime",null);assert(ready(e),"ready doesn't work on null start datetimes");e.set("Start datetime",new Date(Date.now()));assert(ready(e),"ready doesn't work on current datetime");assert(sum([1,2,3])==6,"sum failed");var arr1=[1,2,3,4,5];var arr2=[1,2,3,4,5];shuffle_array(arr1);assert(!arr1.every(function(a,i){return a===arr2[i]}),"shuffle_array failed");var arr=[7,6,8,5,9];var expected=[5,6,7,8,9];assert(sort(arr,function(x){return x},SortDir.Ascending).every(function(arr,i){return arr===expected[i]}),"ascending sort failed");arr=[7,6,8,5,9];expected=[9,8,7,6,5];assert(sort(arr,function(x){return x},SortDir.Descending).every(function(arr,i){return arr===expected[i]}),"descending sort failed");var a=[8,7,6,5,4,3,0,9];var b=copy_array(a);shuffle_array(a);assert(!a.every(function(x,i){return x===b[i]}),"copy_array failed");assert(xbisect(38,true)==39,"xbisect failed (1)");console.log(xbisect(25,false));assert(xbisect(25,false)==24.5,"xbisect failed (2)");assert(xbisect(51,true)==51.5,"xbisect failed (3)");assert(xbisect(75,false)==74.5,"xbisect failed (4)");assert(xbisect(64,true)==128,"xbisect failed (5)");assert(xbisect(64,false)==48,"xbisect failed (6)");